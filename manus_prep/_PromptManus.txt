Eu tenho uma planilha que faz verificações hidráulicas simplificadas em uma rede de esgoto, que utilizo em cursos para ensinar aos alunos qual a capacidade das tubulações baseado nos parâmetros (ajustáveis) de:

- Diâmetro da rede (em milímetros)
- Declividade do trecho (em metro por metro ou %)
- Vazão calculada (Qcalc)

A vazão é calculada através de parâmetros (ajustáveis) de:
- Consumo per capita de água (150 litros por habitante por dia como padrão)
- Taxa de ocupação (4 habitantes por casa como padrão)
- Coeficiente de retorno C (quanto da água consumida retorna para a rede de esgoto, 0,8 como padrão)
- K1 (Coeficiente de consumo máximo diário) e K2 (Coeficiente de consumo máximo horário); que adota-se 1,2 e 1,5 respectivamente.
- Quantidade de residências conectadas na rede (adota-se 100 como padrão)
- n é o Coeficiente de Manning (coeficiente de rugosidade do tubo, adota-se 0,013 como padrão mas pode ser alterado)

Com os parâmetros acima  vazão calcula-se com:
((Consumo per capta * Taxa de ocupação * C * K1 * K2)/86400) * Qtde de residências conectadas -> Resultado da vazão estimada em Litros por Segundo
Se a vazão estimada é maior que a vazão mínima esse é o valor de Qcalc (vazão calculada), caso contrário assume-se o valor de vazão mínima.
A vazão mínima padrão é de 1,5 litros por segundo (ajustável pelo usuário)

As verificações hidráulicas calculadas são:
- Lâmina Líquida ou Tirante, que é a altura que o escoamento atinge em relação ao diâmetro da tubulação. Normalmente o valor máximo permitido é de 75% de lâmina líquida [variável] (redes de esgoto são condutos livres que funcionam com a gravidade)
- Força ou Tensão Trativa, que é uma forma de garantir a autolimpeza da tubulação, evitando o acumulo de sedimentos sólidos das águas residuais na rede e um possível mal funcionamento ou até mesmo bloqueio. Considera-se como Força trativa mínima o valor de 1 Pascal [variável]

Para o cálculo dos fatores acima (Lâmina líquida e Força trativa) é necessário conhecer alguns valores da seção hidráulica:
1)	Área hidráulica (A) em m2. Calcula-se:
=SE(AngTeta>2*PI();0;((Diâmetro/1000)^2)/8*( AngTeta - SEN(AngTeta)))
Onde o AngTeta (ângulo teta) pode ser calculado através da iteração de:
Iteracao1 = E’*(PI()^0.4)+(SEN(PI()))
Iteracao2 = E’*( Iteracao1^0.4)+(SEN(Iteracao1))
Iteracao3=...
(Até o valor das iterações não mudarem mais, ou mudarem bem pouco, normalmente 15 iterações são o suficiente)

E’ por sua vez é calculado:
=8*((((n*Qcalc/1000)/((Declividade^0.5)*((Diametro/1000)^(8/3)))^3)/4)^0.2)

2)	Perímetro Molhado (P). Calcula-se:
=SE(AngTeta >2*PI();0; AngTeta /2*Diametro/1000)

3)	Raio hidráulico (Rh). Calcula-se:
=SE(AngTeta >2*PI();0;(Diametro/1000/4)*( AngTeta -(SEN(AngTeta)))/ AngTeta)

4)	Altura Molhada (y). Calcula-se:
=SE(AngTeta <=2*PI();(1-COS(AngTeta /2))*Diametro/1000/2;0)

Com esses valores calculados chegamos a:
- Lâmina líquida: =y/(diametro/1000) [em porcentagem da altura]
- Força Trativa: =1000*Rh*Declividade*10 [em Pascal]
- Velocidade: =(Rh^(2/3)*Declividade^0.5/n) [Em m/s] (lembrando que n é o coeficiente de manning). A velocidade não possui um valor mínimo, é apenas para outras verificações.

A planilha então funciona para demonstrar aos alunos as condições hidráulicas da rede simulada, mostrando a capacidade de cada diâmetro com relação ao numero de conexões (residencias) cada diâmetro aguenta dadas outras caracteristicas fisicas como a declividade, etc. Portanto os alunos vão preenchendo alguns valores de diâmetros e declividade e preenchem um quadro para se recordarem quantos habitantes ou residências cada diâmetro dadas as características de consumo de água local suportam.

Estou enviando a planilha em anexo para caso você queira verificar alguma das fórmulas ou sua aparência geral.
OBS: AS FORMULAS MOSTRADAS SÃO NO ESTILO DO EXCEL EM PT-BR, portanto SE é IF, SEN é o SENO, e assim por diante...


Eu quero transformar essa planilha simples em um simulador um pouco mais avançado, para isso pensei em criar um site que o usuário possa entrar com os mesmos parâmetros.

- Consumo per capita de água
- Taxa de ocupação
- Coeficiente de retorno C 
- K1 e K2 
- Quantidade de residências conectadas na rede
- Coeficiente de Manning
- Força trativa mínima
- Lâmina líquida máxima
- Vazão mínima
- Declividade
- Diâmetro

E poder visualizar os valores de:
- Vazão estimada
- Vazão calculada
- Área Hidráulica (A)
- Perímetro molhado (P)
- Raio Hidráulico (Rh)
- Lâmina líquida (y/D)
- Força Trativa
- Velocidade

Mas além disso, gostaria que houvesse um desenho esquemático ilustrando os resultados. Como:

1)	Uma seção da tubulação, mostrando o Diametro escolhido, e a fração líquida dentro dela seguindo os valores de Área, perímetro e altura molhada (baseado nos cálculos prévios)

2)	Uma visualização do perfil da rede, que ilustre o diâmetro, a declividade escolhida, a fração líquida dentro da tubulação. Se possível gostaria que esse perfil fosse animada de maneira a permitir o usuário visualizar o escoamento da água residual acontecendo, com as frações líquidas e sólidas (partículas e sólidos um pouco maiores). Um exemplo é: caso os parâmetros escolhidos pelo usuário resultem em uma Força trativa menor que a Força trativa mínima admitida, as partículas sólidas devem ir se acumulando aos poucos até obstruir a rede, impedindo o escoamento da fração líquida...
